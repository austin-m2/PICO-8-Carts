pico-8 cartridge // http://www.pico-8.com
version 4
__lua__
-- video poker
-- by kittenm4ster

-- global constants
cardw = 20
cardh = 28
handsize = 5
prizes = {}
prizes[9] = {n = 'royal flush',     p = 250}
prizes[8] = {n = 'straight flush',  p =  50}
prizes[7] = {n = 'four of a kind',  p =  25}
prizes[6] = {n = 'full house',      p =   9}
prizes[5] = {n = 'flush',           p =   6}
prizes[4] = {n = 'straight',        p =   4}
prizes[3] = {n = 'three of a kind', p =   3}
prizes[2] = {n = 'two pair',        p =   2}
prizes[1] = {n = 'jacks or better', p =   1}

function _init()
  create_deck()
  create_hand()
  dealbutton = create_button()
  fliptimer = create_timer(2)
  cointimer = create_timer(2)
  pressbuttonflash = create_timer(3, false)
  betflash = create_timer(9, true)

  winflash = create_timer(5, true)
  winflash.n = 0
  winflash.cardindex = 0

  bet = 1
  coins = 100
  dispcoins = coins
  cam = {y = 0, dir = 0}
  set_state('intro')
end

function _update()
  rnd(52) -- spin the rng

  update_buttons()
  process_input()
  postupdate_buttons()

  update_dealer()
  update_camera()
  update_flipstate()
  update_betflash()
  update_winflash()
  update_coins()

  if state == 'award' and dispcoins == coins then
    set_state('bet')
  end
end

function _draw()
  cls()
  camera(0, cam.y)

  draw_bg()
  draw_schedule()
  draw_hand()
  if state == 'intro' then
    draw_pressbutton()
  else
    draw_dealbutton()
    draw_bet()
    draw_coins()
  end

  if (state == 'award' or state == 'bet') and prizeindex then
    draw_prize()
  end
end

function assess()
  cards = {}
  for slot in all(hand) do
    add(cards, slot.card)
  end

  local str8a, str8b = straight()
  local flush = flush()
  local threeoak = find_rank_matches(3)

  if str8a and flush then
    if str8a == 10 and str8b == 14 then
      return 9, cards -- royal flush
    else
      return 8, cards -- straight flush
    end
  end

  -- four of a kind
  local r = find_rank_matches(4)
  if r then return 7, r end

  -- full house
  if threeoak then
    local pair = find_rank_matches(2, threeoak[1].rank)
    if pair then
      return 6, merge(threeoak, pair)
    end
  end

  if flush then
    return 5, cards
  elseif str8a then
    return 4, cards
  elseif threeoak then
    return 3, threeoak
  end

  -- two pair
  local m1 = find_rank_matches(2)
  if m1 then
    local m2 = find_rank_matches(2, m1[1].rank)
    if m2 then
      return 2, merge(m1, m2)
    end
  end

  -- jacks or better
  local oldrank
  for c in all(cards) do
    if c.rank >= 11 then
      for d in all(cards) do
        if d ~= c and d.rank == c.rank then
          return 1, {c, d}
        end
      end
    end
  end
end

function clave()
  return shr(band(peek(0x3200 + (68 * 13) + (stat(20) * 2) + 1), 14), 1) > 0
end

function clear_holds()
  for i = 1, handsize do
    local slot = hand[i]
    slot.hold = false
    slot.button.on = false
    if slot.card then slot.card.flash = false end
  end
end

function create_button()
  return {on = false, down = false}
end

function create_deck()
  deck = {}
  local i = 0
  for s = 1, 4 do
    for r = 2, 14 do
      i += 1
      deck[i] = {suit = s, rank = r}
    end
  end
  decksize = 52
end

function create_hand()
  hand = {}
  for i = 1, handsize do
    hand[i] = {
      card = nil,
      flip = {state = 2, dir = 0},
      hold = false,
      button = create_button()
    }
  end
end

function create_timer(delay, on)
  return {
    delay = delay,
    value = 0,
    on = on,

    update =
      function(self)
        if self.value and self.value > 0 then
          self.value -= 1
        else
          self.value = self.delay
          if self.on ~= nil then
            self.on = not self.on
          end
          return true
        end
      end
  }
end

function deal()
  for i = 1, handsize do
    local slot = hand[i]
    if slot.card == nil then
      slot.card = take_card_from_deck()
    end
  end
end

function dealtxt(txt)
  for i = 1, handsize do
    hand[i].card = {suit = 1, rank = txt[i]}
  end
end

function discard()
  for i = 1, handsize do
    local slot = hand[i]
    if not slot.hold then
      slot.card = nil
    end
  end
end

function downbeat()
  -- return true if the intro music is at a good measure for flipping the intro
  -- cards
  return stat(20) == 0 or stat(20) == 16
end

function draw_bet()
  local x, y = 10, 8
  pal()
  color(10)
  if betflash.on and state == 'bet' then
    if bet > 1 then spr(10, x + 15, y) end
    if bet < 5 then spr(10, x + 20, y, 1, 1, true) end
  end
  print('bet: ' .. bet, x, y)
end

function draw_bg()
  pal()
  for y = -128, 128, 16 do
    for x = 0, 128, 16 do
      spr(11, x, y, 2, 2)
    end
  end
end

function draw_card(c, x, y, flipstate)
  local mx, my
  my = 0

  x -= 6
  y -= 6

  if flipstate == 1 then
    mx = 4
    my = 5
  elseif flipstate == 2 then
    mx = 0
    my = 5
  elseif c.suit == 3 then
    mx = 0
  elseif c.suit == 1 then
    mx = 4
  elseif c.suit == 2 then
    mx = 8
  elseif c.suit == 4 then
    mx = 12
  end

  pal()
  pal(1, 0)
  if c.flash then pal(7, 14) end
  mapdraw(mx, my, x, y, 4, 5)

  if flipstate == 0 then
    local r = c.rank
    if c.rank == 10 then
      x -= 2
    else
      local t = {}
      for i=1,10 do t[i]=i end
      t[11] = 'j' t[12] = 'q' t[13] = 'k' t[14] = 'a'
      if t[c.rank] then r = t[c.rank] end
    end

    print(r, x + 19, y + 9, 0)
  end
end

function draw_coins()
  local x, y = 114, 8
  local offset = nlen(coins) * 4
  pal()
  color(10)
  if state == 'bet' and coins < bet and dealbutton.down then color(8) end
  print(dispcoins, x - offset, y)
  spr(9, x, y - 3)
end

function draw_cursor(x, y)
  pal()
  spr(23, x, y)
end

function draw_dealbutton()
  local x, y = 48, 97
  local mx, my

  mx = dealbutton.down and 12 or 8
  if state == 'hold' or state == 'draw' then my = 7 else my = 5 end

  pal()
  mapdraw(mx, my, x, y, 4, 2)

  if sel == 6 and state ~= 'award' then
    draw_cursor(x + 12, y + 14)
  end
end

function draw_hand()
  local x, y = 10, 50
  if cam.y < -(128 - y) then return end

  for i = 1, handsize do
    local card = hand[i].card
    local flipstate = 2

    if card then
      flipstate = hand[i].flip.state
    else
      card = {suit = nil, rank = nil}
    end

    draw_card(card, x, y, flipstate)

    if state == 'hold' or state == 'draw' then
      draw_hold_button(hand[i].button, x, y + cardh + 2)
    end

    if state == 'hold' then
      if i == sel then
        draw_cursor(x + 6, y + cardh + 8)
      end
    end

    x += cardw + 2
  end
end

function draw_hold_button(button, x, y)
  pal()
  if not button.on then
    pal(10, 6)
    pal(4, 5)
  end

  n = button.down and 54 or 38
  spr(n, x - 6, y, 4, 1)
end

function draw_pressbutton()
  if clave() then
    pressbuttonflash.on = true
    reset_timer(pressbuttonflash)
  end
  if pressbuttonflash.on then pressbuttonflash:update() end

  color(pressbuttonflash.on and 12 or 10)
  print('press button', 40, 100)
end

function draw_prize()
  local x, y = 64, 25
  local prize = prizes[prizeindex]

  local len = #prize.n
  local offset = (((len * 4) - 1) / 2)

  pal()
  color(winflash.c)
  pal(10, winflash.c)

  print(prize.n, x - offset, y)

  y += 8

  local width = (nlen(payout) * 4) + 4
  offset = width / 2

  print(payout, x - offset, y)
  spr(9, x + offset - 4, y - 3)
end

function draw_schedule()
  if cam.y == 0 then return end

  local x, y = 20, -84

  for i = 9, 1, -1 do
    local prize = prizes[i]
    
    color(prizeindex == i and winflash.c or 10)
    print(prize.n, x, y)

    local n = get_payout(i)
    local px = x + (22 * 4) - (nlen(n) * 4) + 1
    print(n, px, y)

    y += 8
  end
end

function find_rank_matches(count, ignorerank)
  local r
  for c in all(cards) do
    r = {c}
    if c.rank ~= ignorerank then
      local matches = 0
      for d in all(cards) do
        if d ~= c and d.rank == c.rank then
          add(r, d)
          matches += 1
          if matches + 1 == count then
            return r
          end
        end
      end
    end
  end
end

function flip_card(i)
  local f = hand[i].flip
  if f.state == 0 then
    f.dir = 1
  elseif f.state == 2 then
    f.dir = -1
  end
end

function flush()
  local ok = true
  local suit = cards[1].suit
  for c in all(cards) do
    if c.suit ~= suit then
      ok = false
      break
    end
  end
  return ok
end

function get_payout(i)
  if i == 9 and bet == 5 then return 4000 end
  return prizes[i].p * bet
end

function hide()
  for i = 1, handsize do
    local f = hand[i].flip

    -- if this card slot is not held
    if not hand[i].hold then
      -- if this slot is face up and not already flipping
      if f.state == 0 and f.dir == 0 then
        flip_card(i)
        return false
      end

      -- if this slot is not done flipping
      if f.state ~= 2 then
        return false
      end
    end
  end

  return true
end

function merge(t1, t2)
  for e in all(t2) do add(t1, e) end
  return t1
end

function nlen(n)
  if n < 10 then
    return 1
  elseif n < 100 then
    return 2
  elseif n < 1000 then
    return 3
  elseif n < 10000 then
    return 4
  elseif n < 100000 then
    return 5
  end
end

function postupdate_buttons()
  for i = 1, handsize do
    local button = hand[i].button
    if button.wasdown and not button.down then
      if button.on then
        sfx(4)
      else
        sfx(3)
      end
    end
  end
end

function process_input()
  if btn(2) then -- up
    if not upwaspushed then
      if state == 'bet' or sel ~= 6 then
        cam.dir = -1
      end

      if state == 'hold' then
        if sel == 6 then
          sel = 3
        end
      end
    end
    upwaspushed = true
  else
    upwaspushed = false
  end
  if btn(3) then -- down
    if not downwaspushed then
      cam.dir = 1

      if cam.y >= -16 then
        sel = 6
      end
    end
    downwaspushed = true
  else
    downwaspushed = false
  end

  if state == 'bet' then
    if btnp(0) then -- left
      if bet > 1 then
        sfx(1)
        bet -= 1
        update_betflash(true)
      end
    end
    if btnp(1) then -- right
      if bet < 5 then
        sfx(1)
        bet += 1
        update_betflash(true)
      end
    end
  end

  if state == 'intro' and (btn(4) or btn(5)) then
    set_state('start')
  end

  if cam.y < 0 then
    -- do not process any further input
    return
  end

  if state == 'hold' and btn(5) then
    sel = 6
    set_state('draw')
    quickdraw = true
  else
    quickdraw = false
  end

  if state ~= 'award' then
    if (sel == 6 and btn(4)) or quickdraw then -- a
      if push_button(dealbutton) then
        if state == 'bet' then
          if coins >= bet then
            set_state('deal')
          else
            sfx(5)
          end
        elseif state == 'hold' then
          set_state('draw')
        end
      end
    end
  end

  if state == 'hold' then
    if btnp(0) then -- left
      if sel == 6 then
        sel = 2
      elseif sel > 1 then
        sel -= 1
      end
    end
    if btnp(1) then -- right
      if sel == 6 then
        sel = 4
      elseif sel < 5 then
        sel += 1
      end
    end

    if btn(4) and sel ~= 6 then -- a
      local b = hand[sel].button
      if push_button(b) then
        if b.on then
          sfx(3)
        else
          sfx(4)
        end
        hand[sel].hold = b.on
      end
    end
  end

  if btn(4) then
    btn4wasdown = true
  else
    btn4wasdown = false
  end
end

function push_button(b)
  if not btn4wasdown or b.wasdown then
    b.down = true
  end

  if not btn4wasdown then
    b.wasdown = true
    b.on = not b.on
    return true
  end
end

function reset_timer(t)
  t.value = t.delay
end

function set_state(s)
  if s == 'intro' then
    music(5)
    dealstep = -5
  elseif s == 'start' then
    music(-1)
    dealstep = -1
  elseif s == 'bet' then
    sel = 6
  elseif s == 'deal' then
    music(-1)
    sfx(6)
    coins -= bet
    clear_holds()
    wincards = nil
    dealstep = 0
    prizeindex = nil
  elseif s == 'draw' then
    sfx(7)
    dealstep = 1
  elseif s == 'award' then
    reset_timer(winflash)
    winflash.on = true
    winflash.n = 0
    winflash.cardindex = 0
  end

  state = s
end

function show()
  for i = 1, handsize do
    local f = hand[i].flip

    -- if this slot is face down and not already flipping
    if f.state == 2 and f.dir == 0 then
      flip_card(i)
      return false
    end

    -- if this slot is not done flipping
    if f.state ~= 0 then
      return false
    end
  end

  return true
end

function straight()
  local a, b
  for c in all(cards) do
    if c.rank == 14 then
      a = 1
    else
      a = c.rank
    end
    b = a

    local foundnext
    repeat 
      foundnext = false
      for d in all(cards) do
        if d.rank == b + 1 then
          b = d.rank
          foundnext = true
          break
        end
      end
    until foundnext == false

    if (b - a) + 1 == 5 then
      return a, b
    end
  end
end

function take_card_from_deck()
  local index = flr(rnd(decksize)) + 1

  -- copy the card
  local card = {
    suit = deck[index].suit,
    rank = deck[index].rank
  }

  -- shift the other cards over, removing the card from the deck
  for i = index, decksize - 1 do
    deck[i] = deck[i + 1]
  end
  deck[decksize] = nil
  decksize -= 1

  return card
end

function update_betflash(reset)
  if reset then
    betflash.on = true
    reset_timer(betflash)
  end
  betflash:update()
end

function update_buttons()
  for i = 1, handsize do
    local button = hand[i].button
    button.wasdown = button.down
    button.down = false
  end

  dealbutton.wasdown = dealbutton.down
  dealbutton.down = false
end

function update_camera()
  local dest
  if cam.dir == -1 then
    dest = -107
  elseif cam.dir == 1 then
    dest = 0
  end

  if not dest then
    return
  end

  local speed = (dest - cam.y) * .5
  if speed < -20 then speed = -20 end

  cam.y += speed

  if dest < 0 and cam.y <= dest then
    cam.y = dest
    cam.dir = 0
  end

  if cam.y >= -.5 then
    cam.y = 0
    cam.dir = 0
  end
end

function update_coins()
  if not cointimer:update() then return end
  if dispcoins < coins then
    dispcoins += 1
    sfx(2)
  elseif dispcoins > coins then
    dispcoins -= 1
  end
end

function update_dealer()
  if dealstep == -5 then
    dealtxt({'v','i','d','e','o'})
    if show() and downbeat() then dealstep += 1 end
  elseif dealstep == -4 then
    if hide() and downbeat() then
      dealtxt({'p','o','k','e','r'})
      dealstep += 1
    end
  elseif dealstep == -3 then
    if show() and downbeat() then dealstep += 1 end
  elseif dealstep == -2 then
    if hide() and downbeat() then dealstep = -5 end
  elseif dealstep == -1 then
    if hide() then set_state('bet') end
  elseif dealstep == 0 then
    create_deck()
    dealstep += 1
  elseif dealstep == 1 then
    if hide() then
      discard()
      deal()
      dealstep += 1
    end
  elseif dealstep == 2 then
    if show() then dealstep += 1 end
  elseif dealstep == 3 then
    if state == 'deal' then
      state = 'hold'
    elseif state == 'draw' then
      prizeindex, wincards = assess()
      local pi = prizeindex
      if pi then
        if pi > 1 then
          m = (pi == 9) and 1 or 9
          music(m, 0, 7)
        else
          sfx(8)
        end
        payout = get_payout(pi)
        coins += payout     
      end
      set_state('award')
    end
  end
end

function update_flipstate()
  if not fliptimer:update() then return end

  for i = 1, handsize do
    local f = hand[i].flip
    if f.dir == 1 then
      if f.state < 2 then
        f.state += 1
      else
        f.dir = 0
      end
    end
    if f.dir == -1 then
      if f.state > 0 then
        f.state -= 1
      else
        f.dir = 0
      end
    end
    if f.dir ~= 0 and f.state == 1 then
      sfx(0)
    end
  end
end

function update_winflash()
  local f = winflash
  if f.n >= 122 and not f.on then return end

  if f:update() then
    if wincards and f.n < 100 then
      if f.cardindex > 0 then wincards[f.cardindex].flash = false end
      f.cardindex += 1
      if f.cardindex > #wincards then
        f.cardindex = 1
      end

      if f.cardindex == 1 and f.n >= 11 and state ~= 'award' then
        f.n = 100
      else
        wincards[f.cardindex].flash = true
        if f.n == 99 then f.n = 0 end
      end
    end

    f.n += 1
    f.c = (f.on and 12 or 10)

    if f.n == 122 then
      if prizeindex and prizeindex > 1 then
        f.n = 0
        f.cardindex = 0
      end
    end
  end
end
__gfx__
0000000077111777777177777778777778878877777777777777777777777777777777770000000000a000003333333333333333000000000000000000000000
000000007711177777111777778887778888888777711177777111777777877777778777000000000aa000003333333333333333000000000000000000000000
00000000111111177111117778888877888888877777177777771777777888777778887700000000aaa000003333333333333333000000000000000000000000
000000001111111711111117888888878888888771171711711717117788888777888887000000000aa000003333333333333333000000000000000000000000
0000000011717117117171177888887778888877711111117111111178888888788888880aa0000000a000003133333333333333000000000000000000000000
000000007771777777717777778887777788877771111111771111177788888778888888aaaa0000000000003333333333333333000000000000000000000000
000000007711177777111777777877777778777777711177777111777778887778888888aaaa0000000000003331333333333333000000000000000000000000
0000000077777777777777777777777777777777777111777777177777778777778878870aa00000000000003333333333333333000000000000000000000000
00000000000000000000000000000000000000000000000000000000000880000000000000000000000000003333313333333333000000000000000000000000
00000000000000000000000000000000000000000000000000000000008888000000000000000000000000003333333333333333000000000000000000000000
00000000000000000000000000000000000000000000000000000000088888800000000000000000000000003333333333331333000000000000000000000000
00000000000000000000000000000000000000000000000000000000888888880000000000000000000000003333333333333333000000000000000000000000
00000000000000000000000000000000000000000000000000000000008888000000000000000000000000003333333331333333000000000000000000000000
00000000000000000000000000000000000000000000000000000000008888000000000000000000000000003333333333333333000000000000000000000000
00000007777777777000000000000000000000000000000000000000000000000000000000000000000000003333333333333333000000000000000000000000
00000077777777777700000000000000000000000000000000000000000000000000000000000000000000003333333333333333000000000000000000000000
0000007777777777770000007887777700000077770000000000000aaaaaaaaaaaaaaaaaa0000000000000000000000000000000000000000000000000000000
000000777777777777000000888878870000007877000000000000aaa4a4aa44a4aaa44aaa000000000000000000000000000000000000000000000000000000
000000777777777777000000888878870000007877000000000000aaa4a4a4a4a4aaa4a4aa000000000000000000000000000000000000000000000000000000
000000777777777777000000788777770000007777000000000000aaa444a4a4a4aaa4a4aa000000000000000000000000000000000000000000000000000000
000000777777777777000000777778870000007777000000000000aaa4a4a4a4a4aaa4a4aa000000000000000000000000000000000000000000000000000000
000000777777777777000000788788880000007787000000000000aaa4a4a44aa444a444aa000000000000000000000000000000000000000000000000000000
0000007777777777770000007887888800000077870000000000004aaaaaaaaaaaaaaaaaa4000000000000000000000000000000000000000000000000000000
00000077777777777700000077777887000000777700000000000004444444444444444440000000000000000000000000000000000000000000000000000000
00000077777777777700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000777777777700000000000000000000000000000000000000aaaaaaaaaaaaaaaaaa0000000000000000000000000000000000000000000000000000000
000000000000000000000000000000000000000000000000000000aaa4a4aa44a4aaa44aaa000000000000000000000000000000000000000000000000000000
000000000000000000000000000000000000000000000000000000aaa4a4a4a4a4aaa4a4aa000000000000000000000000000000000000000000000000000000
000000000000000000000000000000000000000000000000000000aaa444a4a4a4aaa4a4aa000000000000000000000000000000000000000000000000000000
000000000000000000000000000000000000000000000000000000aaa4a4a4a4a4aaa4a4aa000000000000000000000000000000000000000000000000000000
000000000000000000000000000000000000000000000000000000aaa4a4a44aa444a444aa000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000aaaaaaaaaaaaaaaaaa0000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
06666666666666600000000000000000066666666666666000000000000000000000000000000000000000000000000000000000000000000000000000000000
66666666666666660666666666666660666666666666666606666666666666600000000000000000000000000000000000000000000000000000000000000000
66666666666666666666666666666666666666666666666666666666666666660000000000000000000000000000000000000000000000000000000000000000
65566555665565666666666666666666655665556655656566666666666666660000000000000000000000000000000000000000000000000000000000000000
65656566656565666556655566556566656565656565656565566555665565650000000000000000000000000000000000000000000000000000000000000000
65656556656565666565656665656566656565566565656565656565656565650000000000000000000000000000000000000000000000000000000000000000
65656566656565666565655665656566656565656565656565656556656565650000000000000000000000000000000000000000000000000000000000000000
65656566656565666565656665656566656565656565656565656565656565650000000000000000000000000000000000000000000000000000000000000000
65656566655565666565656665656566656565656555656565656565656565650000000000000000000000000000000000000000000000000000000000000000
65656565656565656565656665556566656565656565655565656565655565650000000000000000000000000000000000000000000000000000000000000000
65556555656565556565656565656565655565656565655565656565656565550000000000000000000000000000000000000000000000000000000000000000
66666666666666666555655565656555666666666666666665556565656565550000000000000000000000000000000000000000000000000000000000000000
66666666666666666666666666666666666666666666666666666666666666660000000000000000000000000000000000000000000000000000000000000000
56666666666666656666666666666666566666666666666566666666666666660000000000000000000000000000000000000000000000000000000000000000
05555555555555500666666666666660055555555555555006666666666666600000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000006600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000066660000000000000660000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000066660000000000006666000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000066660000000000006666000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000066660000000000006666000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000066660000000000006666000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000066660000000000006666000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000066660000000000006666000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000066660000000000006666000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000056650000000000006666000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000005500000000000000660000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__gff__
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__map__
1011111210111112101111121011111200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
2001212220022122200321222004212200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
2021212220212122202121222021212200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
2021052220210622202107222021082200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
3031313230313132303131323031313200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1011111200101200604041616242436300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
2023232200242500705051717252537300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
2023232200242500604445616246476300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
2023232200242500705455717256577300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
3031313200303200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__sfx__
010200000c764137601b7043f7040370416704327041670416704167041670411704187041a7042970426704217041e7043e7043e70400704247042070421704227042a7040270400704397043f7040070400704
010300002805503000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
010500002f74034745237002470000700007000070000700007000070000700007000070000700007000070000700007000070000700007000070000700007000070000700007000070000700007000070000700
0104000018075190001e00022000250002a0002500016000240001c0001f000240000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000006
01040000240751e005240052800418000180001d0001b000220001f0002200027000240002e000330003300035000370003a0003a0003a00035000300002b00027000220001f0001b0001b000130000f0000c000
010800001857512575180050000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0108000028575245752d5750050000500005000050000500005000050000500005000050000500005000050000500005000050000500005000050000500005000050000500005000050000500005000050000500
0108000029575265752f5753050500500005000050000500005000050000500005000050000500005000050000500005000050000500005000050000500005000050000500005000050000500005000050000500
010800002b5752857530575215000050000500005000050000500005000050000500005000050000500005000050000500005000050000500005000050000500005000050000500005000050000500005002a505
01100000004720047207300073700c3750c3700a3700c370053000537007370104000a3700c3000c3700440005370004000630000400033700240000370053710730007370033710337203372033720440004403
011000001807300000070001060028653000000000000000000000000018073000002865300000000000b0730c073000000000010000286530000000000000001807318003130730000028653000002d6532d653
011000000500007400004001740013400174001540016400134001640013400164001340016400154001540015400104001140015400114001540011400154001140015400114001540011400154001140015400
011000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
011200003f72528703287033f72528703287033f7252870528705287053f72528705287053f72528705287053f72500705007053f72500705007053f7250070500705007053f72500705007053f725007053c700
011200000c07005000000000c070070700000000000000000c07000000000000707007070000000c070000000e07007000000000e07009070000000e0000e0000e07000000000000907009070000000307002000
0112000002070020000400002070090701d0001c00002000070701a000190000b0701900000000050700000004070000000b0000b0701a00000000040701a0000907000000000000907010070100000f0700d300
011200000e0700e0000e0000e070090701d0000a0700b0000b0701d0001c000100701b0001c0000b07024002090702400209000090701007010000000001a002090701a002000000907010070000000f07000000
011200000e070150000000017000090701800003000170000e070070000200009070090700600015000060000e07018000000000e07009070000000e0700e0000d07015002000000d07000000000000d07019000
011200001357015570005001757018500185701850017570155001557017500145701450015570155001857018570185001457014500145721457214572145721450214502005000050000500005000050000500
011200001f50015570105001757018500185701a5001a57018500185701750017570165701750017570175001f5701f5021657016500165721657216500165001750016500165000050000500005000050000500
011200001f5001f5701f5001d5701c5001c570005001a5701d570005001c57000500165701657017500175701957119572005001c57019570195001650016570165720050000500005000050000500005001c570
011200001c5001a57000500185700050015570005001b5721b572005001a570005001857000500155701750018570185721750017570145721457200500005002b57000500005002b570005001f5002b57000500
011000000e0700e0700e0750e0700e0700e0750d0700d0750d0700d0000d0050c0720c0720c0720c0720c0720c0720c0720c0720c0720c0720c0720c0720c0720c0000c0000c0000c00000500005000050000500
011000001d5401d5401d5451d5401d5401d5451d5401d5451d5401d5051d5051c5421c5421c5421c5421c5421c5421c5421c5421c5421c5421c5421c5421c5421c5021c502105020050000500005000050000500
011000002154021540215452154021540215452354023545235402350023505235422354223542235422354223542235422354223542235422354223542235422350223502235020000000000000000000000000
010c00000c0700c0700c0700c075070700707007070070750c0700c0700c0700c0750c0700c0700c0750b0700a0700a0700a0700a075050700507005070050750a0700a0700a0700a0750a0700a0700a0750b070
010c00001c5401c5401c5451c5401c5001c50518000180001c5401c5401c5401c5401b5001b5001b5001a5001a5401a5401a540180001a5401a5451a5001a5401a5421a5421a5421a54200000000000000000000
010c00001354013540135451354000000000000000000000135401354013540135400000000000000000000011540115401154000000115401154500000115401154211542115421154200000000000000000000
010c00001c5401c5401c5451c540000000000000000000001c5401c5401c5001c5001c5401c5401c5401d5401a5001a5021a5021a502000000000000000000000000000000000000000000000000000000000000
010c0000135401354013545135400000000000000000000013540135400000000000135401354013540165401d5001d5021d5021d502000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__music__
00 41424344
03 090a4344
01 41424344
00 41424344
00 41424344
01 0d0e1244
00 0d0f1344
00 0d101444
02 0d111544
00 16171844
01 191a1b44
02 191c1d44
00 41424344
00 41424344
00 41424344
00 41424344
00 41424344
00 41424344
00 41424344
00 41424344
00 41424344
00 41424344
00 41424344
00 41424344
00 41424344
00 41424344
00 41424344
00 41424344
00 41424344
00 41424344
00 41424344
00 41424344
00 41424344
00 41424344
00 41424344
00 41424344
00 41424344
00 41424344
00 41424344
00 41424344
00 41424344
00 41424344
00 41424344
00 41424344
00 41424344
00 41424344
00 41424344
00 41424344
00 41424344
00 41424344
00 41424344
00 41424344
00 41424344
00 41424344
00 41424344
00 41424344
00 41424344
00 41424344
00 41424344
00 41424344
00 41424344
00 41424344
00 41424344
00 41424344

